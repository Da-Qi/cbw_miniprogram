<view class="container">
  <!-- 标题 -->
  <view class="form-item">
    <t-input placeholder="请输入标题" bindchange="onTitleChange" value="{{route.title}}">
        <view slot="label" class="custom-label"> 路线标题 </view>
    </t-input>
  </view>

    <!-- 海报图 -->
    <view class="form-item">
        <t-cell title="海报图" />
        <t-upload
            mediaType="{{['image']}}"
            max="{{1}}"
            files="{{route.poster_image}}"
            bind:add="handleAddPosterImage"
            bind:remove="handleRemovePosterImage"
        >
        </t-upload>
    </view>

    <!-- 轮播图 -->
    <view class="form-item">
        <t-cell title="轮播图" />
        <t-upload
            mediaType="{{['image']}}"
            files="{{route.carousel}}"
            bind:add="handleAddCarouselImage"
            bind:remove="handleRemoveCarouselImage"
        >
        </t-upload>
    </view>

    <!-- 详情长图 -->
    <view class="form-item">
        <t-cell title="详情图" />
        <t-upload mediaType="{{['image']}}" max="{{1}}" files="{{route.detailImages}}" bind:add="handleAddDetailImage" bind:remove="handleRemoveDetailImage">
        </t-upload>
    </view>

  <!-- 是否可用 -->
    <t-cell title="是否可用：" bordered="{{false}}">
        <t-switch defaultValue="{{true}}" value="{{route.active}}" bindchange="onActiveChange" slot="note" />
    </t-cell>

  <!-- 展示优先级 -->
  <view class="form-item">
    <t-input label="优先级：" placeholder="(数字越大越靠前)" align="right" bindchange="onPriorityChange" value="{{route.priority}}" type="number" />
  </view>

  <view class="page-title">服务表</view>
  <!-- 服务列表 -->
  <view class="service-list">
    <!-- 服务项标题栏 -->
    <view class="service-header">
      <view class="service-name">服务名称</view>
      <view class="service-price">售价</view>
      <view class="service-person-count">人数</view>
      <view class="service-action">操作</view>
    </view>
    
    <!-- 服务项列表 -->
    <block wx:for="{{services}}" wx:key="index">
      <view class="service-item" animation="{{item.animationData}}">
        <view class="service-name">
          <input 
            type="text" 
            value="{{item.service_name}}" 
            bindblur="onServiceNameChange" 
            data-index="{{index}}"
            placeholder="请输入服务名称"
          />
        </view>
        <view class="service-price">
          <input 
            type="digit" 
            value="{{item.price}}" 
            bindblur="onServicePriceChange"
            data-index="{{index}}"
            placeholder="0.00"
          />
        </view>
        <view class="service-person-count">
          <input 
            type="number" 
            value="{{item.person_count}}" 
            bindblur="onServicePersonCountChange"
            data-index="{{index}}"
            placeholder="1"
          />
        </view>
        <view class="service-action">
          <button 
            class="delete-btn" 
            bindtap="deleteService" 
            data-index="{{index}}"
            wx:if="{{services.length > 1}}"
          >
            <icon type="clear" size="18" color="#ff4d4f" />
          </button>
        </view>
      </view>
    </block>
    
    <!-- 新增服务按钮 -->
    <button class="add-service-btn" bindtap="addService">
      <icon type="plus" size="20" color="#1677ff" />
      <text>新增服务</text>
    </button>
  </view>

  <!-- 保存按钮 -->
    <view class="modal-footer">
        <button class="modal-btn cancel-btn" bindtap="closeBack">取消</button>
        <button class="modal-btn confirm-btn" bindtap="saveRoute">{{isEditing ? '更新' : '创建'}}</button>
    </view>
</view>
